<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" name="viewport">
		<meta content="yes" name="apple-mobile-web-app-capable">
		<meta content="black" name="apple-mobile-web-app-status-bar-style">
		<meta content="telephone=no" name="format-detection">
		<meta content="email=no" name="format-detection">
		<!--移动端的常用适配-->
		<!--样式表引入开始-->
		<link rel="stylesheet" type="text/css" href="../css/reset.css"/>
		<link rel="stylesheet" type="text/css" href="../css/swiper-3.3.1.min.css"/>
		<link rel="stylesheet" type="text/css" href="../css/common.css"/>
		<link rel="stylesheet" type="text/css" href="../css/shopcart.css"/>
		<!--样式表引入结束-->
		<title>6688手机商城</title>
	</head>
	<body>
		<div class="headerIcon">
					<span class="jiantou"><i class="iconfont icon-jiantou1"></i></span>
					<span class="fenxiang"><i class="iconfont icon-fenxiang"></i></span>
		</div>
		<section class="main">
			<header class="ad"><a href="#">双11限期活动</a>，<a href="#">消费账户</a>  <a href="#">(E元)</a> <a href="#">充值100得115元。</a></header>
			<div class="goodsImg">
				<img src="../images/loading.gif" />
				
			</div>
			<div class="goodsInfo">
				<p class="goodsName">新疆有机红提葡萄　(2kg)　-鲜果上市特价</p>
				<p class="goodsPrice">商城...&nbsp;&nbsp;&nbsp;&nbsp;<b>66.00</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;商品货号：<span>007</span></p>
				<p class="tips">每单满70元包邮。满300元，下单后会自动95折。</p>
				<p class="notice"><b>全国配送，不支持货到付款</b></p>
			</div>
			<div class="bg"></div>
			<div class="goodsList">
				<ul>
					<li><a >冰糖心苹果礼盒装</a></li>
					<li><a >冰糖心苹果家庭装</a></li>
					<li><a >皮亚曼大石榴</a></li>
					<li><a >无籽葡萄2kg</a></li>
					<li class="active"><a >红提葡萄2kg</a></li>
				</ul>
			</div>
			<div class="bg"></div>
			<div class="count">
				<div class="content">数量：</div>
				<div class="add">
					<div class="down">-</div>
					<div class="num">1</div>
					<div class="up">+</div>
				</div>
			</div>
			<div class="bg"></div>
			<div class="tuwenxiangqing"><i class="iconfont icon-iconmoban2"></i>&nbsp;&nbsp;图文详情</div>
			<div class="bg"></div>
			<div class="more">&lt;&nbsp;&nbsp;&nbsp;&nbsp;第二件特价&nbsp;&nbsp;&nbsp;&nbsp;&gt;</div>
			<div class="bg"></div>
			<div class="swiper-container">
			    <div class="swiper-wrapper">
			        <div class="swiper-slide">
			        	<img src="../images/li1.jpg" />
			        	<div class="content">预购4月农产万元，马上送600E元，可参加特价活动</div>
			        	<p>￥10000.00</p>
			        </div>
			        <div class="swiper-slide">
			        	<img src="../images/li2.jpg" />
			        	<div class="content">以特价96元购买昆仑雪菊大罐80克（96折，原价100元）</div>
			        	<p>￥96.00</p>
			        </div>
			        <div class="swiper-slide">
			        	<img src="../images/li3.jpg" />
			        	<div class="content">以特价191元购买野生黑枸杞（120g，88折，原价218元）</div>
			        	<p>￥191.00</p>
			        </div>
			        <div class="swiper-slide">
			        	<img src="../images/li4.jpg" />
			        	<div class="content">以特价175元购买阿勒颇钻石级限量版古皂180克（窖藏五年，8折，原价218元）</div>
			        	<p>￥175.00</p>
			        </div>
			        <div class="swiper-slide">
			        	<img src="../images/li5.jpg" />
			        	<div class="content">以特价226元购买和田大枣-混级散装2公斤（箱）（原价255元）</div>
			        	<p>￥226.00</p>
			        </div>
			        <div class="swiper-slide">
			        	<img src="../images/li6.jpg" />
			        	<div class="content">以特价156元购买特级薄皮核桃（2公斤散装）-坚果（原价159元）</div>
			        	<p>￥156.00</p>
			        </div>
			        <div class="swiper-slide">
			        	<img src="../images/li7.jpg" />
			        	<div class="content">以特价89元购买野生沙枣纯蜜500g（9折，原价99元）</div>
			        	<p>￥89.00</p>
			        </div>
			        <div class="swiper-slide">
			        	<img src="../images/li8.jpg" />
			        	<div class="content">以特价295元购买有机大米礼盒（1kg*6袋，特价每斤约24.5元）</div>
			        	<p>￥295.00</p>
			        </div>
			        <div class="swiper-slide"></div>
			        
			    </div>
		
			    <!-- 如果需要滚动条 -->
			    <div class="swiper-scrollbar"></div>
			</div>
			<div class="bg"></div>
			<div class="footer_img">
				<img src="../images/foot_img1.jpg" />
				<img src="../images/foot_img2.jpg" />
				<img src="../images/foot_img3.jpg" />
			</div>
		</section>
		<div class="footer_bg"></div>
		<footer class="footer">
			<div class="guanzhu"><i class="iconfont icon-xiazai11"></i><p>关注</p></div>
			<div class="addGoods"><a>加入购物车</a></div>
			<div class="gouwuche">
				<a href="gouwuche.html">
				<i class="iconfont icon-gouwuche"></i>
				<span></span></a>
			</div>
		</footer>
		<div id="show">收藏成功</div>
	</body>
	<script type="text/javascript" src="../js/swiper-3.3.1.min.js" ></script>
	<script type="text/javascript" src="../js/jquery-1.11.3.js" ></script>
	<script>
	
		var mySwiper = new Swiper ('.swiper-container', {
		    scrollbar: '.swiper-scrollbar',
		    scrollbarHide:true,
		    autoplay:3000,
		    autoplayDisableOnInteraction: false,//触摸结束后继续轮播
	        slidesPerView:2,/*网格分布：1为在容器区域出现一张图；2：在容器区域出现两张图；3：在容器区域出现三张图*/    
		  })
		
		

		$(document).on("touchstart",".count .add .up",function(){
			var num=$(".count .add .num").html()*1+1;
			$(".count .add .num").html(num);
		})
		$(document).on("touchstart",".count .add .down",function(){
			var num=$(".count .add .num").html()*1-1;
			if(num<1){num=1};
			$(".count .add .num").html(num);			
		})
		
		
		var other=0;
		for(var i=0;i<localStorage.length;i++){
			var key=localStorage.key(i);
			if(key.indexOf("goods_")==-1){
				other++;
			}
		}
		var listCount=localStorage.length-other;
		$(".footer .gouwuche span").html(listCount);
		
		var url=String(window.location);
		var goodsId,goodsImg,goodsName,goodsPrice;
		if(url.indexOf("?")!=-1){
			
			goodsId=url.split("?")[1].split("&")[0].split("=")[1];
			var $id=goodsId.substring(0,goodsId.length-1);
			var $index=goodsId.split($id)[1]-1;
			$.ajax({
			   type:"get",
			   url:"../mockdata/goodlist.json",
			   dataType:"json",
			   success:function(result){	
				    for(var i=0;i<result.length;i++){
				    	if(result[i].id==$id){ 
				    		goodsImg=result[i]["src"][$index];
				    		goodsName=result[i].dec[$index];
				    		goodsPrice=result[i].price[$index];
							$(".main .goodsInfo .goodsPrice span").html(goodsId);
							$(".main .goodsImg img").attr("src","../images/"+goodsImg);
							$(".main .goodsInfo .goodsName").html(goodsName);
							$(".main .goodsInfo .goodsPrice b").html(goodsPrice);
				    	}
				    }
			   }
			});
		}
		
			
		$(document).on("touchstart",".footer .addGoods",function(){
			var num=$(".count .add .num").html()*1;
			for (var i=0;i<localStorage.length;i++){
				var key=localStorage.key(i);
				if(key=="goods_"+goodsId){
					var obj=JSON.parse(localStorage.getItem(key));
					var goodsnum=obj["goodsnum"];
					num+=goodsnum;
					break;
				}			
			}		
			var goodsList={"goodsId":goodsId,"goodsImg":goodsImg,"goodsName":goodsName,"goodsPrice":goodsPrice,"goodsnum":num}
			localStorage.setItem("goods_"+goodsId,JSON.stringify(goodsList));
			listCount=localStorage.length-other;
			$(".footer .gouwuche span").html(listCount);
		});
		
		$(document).on("touchstart",".goodsList ul li",function(){
			$(this).addClass("active").siblings().removeClass("active");
		});
		
		
		$(document).on("touchstart",".headerIcon .icon-jiantou1",function(){
			/*http://127.0.0.1:8020/%E4%BF%AE%E6%94%B9/shopDetail.html?id=xianguo1&index=0*/
			var index=url.split("&")[1].split("=")[1];
			window.location.href="../index.html?Index="+index;
		})
		
		
		//收藏
		for (var i=0;i<localStorage.length;i++){
				var key=localStorage.key(i);
				if(key=="like_"+goodsId){					
					$(".footer .guanzhu").addClass("active");
					break;
				}			
		}
		$(document).on("touchstart",".footer .guanzhu",function(){
			var flag=true;
			$("#show").show();
			var timer=null;
			timer=setTimeout(function(){
				$("#show").hide();
				clearTimeout(timer);
			},3000);
			var goodsList={"goodsId":goodsId,"goodsImg":goodsImg,"goodsName":goodsName,"goodsPrice":goodsPrice}
			for (var i=0;i<localStorage.length;i++){
				var key=localStorage.key(i);
				if(key=="like_"+goodsId){					
					flag=false;
					break;
				}			
			}
			if(flag){
				localStorage.setItem("like_"+goodsId,JSON.stringify(goodsList));
				$("#show").html("收藏成功");
				$(this).addClass("active");
			}else{
				localStorage.removeItem("like_"+goodsId,JSON.stringify(goodsList));
				$("#show").html("取消收藏");
				$(this).removeClass("active");
			}
			
		})
	</script>
</html>
